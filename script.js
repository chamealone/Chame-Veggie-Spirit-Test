const questions = [
  {
    "narrative": "Kamu dan Chame melangkah menyusuri lorong yang sempit. Tiba-tiba lorong bercabang menjadi lima jalan berbeda. Kamu memilih jalan mana?",
    "options": [
      { "text": "A. Jalan berlantai batu tua", "spirits": ["Kroot","Onyun"] },
      { "text": "B. Jalan yang ditumbuhi lumut hijau", "spirits": ["Potatoad","Mubii"] },
      { "text": "C. Lorong berhiaskan bunga kelopak ungu", "spirits": ["Bitty","Banion"] },
      { "text": "D. Koridor logam dingin berderet rapi", "spirits": ["Gingeer","Onyun"] },
      { "text": "E. Relung remang dengan cahaya berpendar", "spirits": ["Alliowl","Banion"] }
    ]
  },
  {
    "narrative": "Selanjutnya kalian menemukan hamparan sarang laba-laba besar di sudut. Bentuk sarang itu terlihat seperti...?",
    "options": [
      { "text": "A. Jaring simetris sempurna", "spirits": ["Onyun","Gingeer"] },
      { "text": "B. Anyaman acak berantakan", "spirits": ["Potatoad","Bitty"] },
      { "text": "C. Siluet hati retak", "spirits": ["Banion","Alliowl"] },
      { "text": "D. Jejak spiral memikat", "spirits": ["Bitty","Kroot"] },
      { "text": "E. Kepingan kabut tipis", "spirits": ["Mubii","Bitty"] }
    ]
  },
  {
    "narrative": "Chame menatapmu penasaran. Apa yang kamu lakukan pada sarang itu?",
    "options": [
      { "text": "A. Berusaha membebaskan satu untai", "spirits": ["Mubii","Potatoad"] },
      { "text": "B. Menyentuh lembut lalu mundur", "spirits": ["Kroot","Alliowl"] },
      { "text": "C. Membakar ujungnya dengan cahaya kecil", "spirits": ["Gingeer","Banion"] },
      { "text": "D. Lewat di sekitarnya tanpa menyentuh", "spirits": ["Bitty","Gingeer"] },
      { "text": "E. Ajak Chame berdiskusi dulu", "spirits": ["Onyun","Banion"] }
    ]
  },
  {
    "narrative": "Kemudian kalian tiba di sebuah pintu tua dengan lubang kunci. Kunci mana yang kamu pilih dari tumpukan?",
    "options": [
      { "text": "A. Kunci kayu hangat", "spirits": ["Potatoad","Kroot"] },
      { "text": "B. Kunci bunga ungu rapuh", "spirits": ["Bitty","Banion"] },
      { "text": "C. Kunci baja berderet", "spirits": ["Onyun","Gingeer"] },
      { "text": "D. Kunci berkarat dengan ukiran", "spirits": ["Alliowl","Banion"] },
      { "text": "E. Kunci bercahaya lembut", "spirits": ["Mubii","Bitty"] }
    ]
  },
  {
    "narrative": "Akhirnya pintu terbuka, mengungkap lorong nostalgia. Apa perasaan pertama yang muncul di dadamu?",
    "options": [
      { "text": "A. Hangat rindu", "spirits": ["Bitty","Potatoad"] },
      { "text": "B. Canggung ingin lari", "spirits": ["Banion","Onyun"] },
      { "text": "C. Tenang damai", "spirits": ["Mubii","Kroot"] },
      { "text": "D. Sedih pilu", "spirits": ["Alliowl","Banion"] },
      { "text": "E. Penasaran ingin melihat lebih jauh", "spirits": ["Gingeer","Bitty"] }
    ]
  },
  {
    "narrative": "Kalian melangkah di atas lantai berlapis kenangan. Benda mana yang paling menarik perhatianmu?",
    "options": [
      { "text": "A. Bola bekas mainan", "spirits": ["Potatoad","Mubii"] },
      { "text": "B. Gambar kabur potret diri", "spirits": ["Alliowl","Bitty"] },
      { "text": "C. Catatan berisi harapan", "spirits": ["Bitty","Banion"] },
      { "text": "D. Rantai kunci pelindung", "spirits": ["Onyun","Gingeer"] },
      { "text": "E. Kepingan cermin kecil", "spirits": ["Gingeer","Kroot"] }
    ]
  },
  {
    "narrative": "Sebuah kotak terbungkus kain lusuh menanti. Apa isi kotaknya?",
    "options": [
      { "text": "A. Satu foto lama", "spirits": ["Alliowl","Banion"] },
      { "text": "B. Batu berwarna hangat", "spirits": ["Kroot","Potatoad"] },
      { "text": "C. Surat singkat tapi pedih", "spirits": ["Gingeer","Bitty"] },
      { "text": "D. Biji kecil bercahaya", "spirits": ["Mubii","Bitty"] },
      { "text": "E. Buku mini bergambar", "spirits": ["Bitty","Onyun"] }
    ]
  },
  {
    "narrative": "Tiba-tiba terdengar suara dari lorong sebelah. Suara itu memanggilmu dengan kata?",
    "options": [
      { "text": "A. Nama kecilmu", "spirits": ["Banion","Bitty"] },
      { "text": "B. Gelak tawa lembut", "spirits": ["Potatoad","Mubii"] },
      { "text": "C. Teguran pelan", "spirits": ["Gingeer","Onyun"] },
      { "text": "D. Bisikan rahasia", "spirits": ["Alliowl","Kroot"] },
      { "text": "E. Nyanyian samar", "spirits": ["Bitty","Banion"] }
    ]
  },
  {
    "narrative": "Kamu memutuskan mengikuti suara. Apa yang kamu rasakan saat melangkah?",
    "options": [
      { "text": "A. Genggaman hangat", "spirits": ["Mubii","Potatoad"] },
      { "text": "B. Kaku dan takut", "spirits": ["Banion","Onyun"] },
      { "text": "C. Penuh harapan", "spirits": ["Bitty","Gingeer"] },
      { "text": "D. Tenang penasaran", "spirits": ["Kroot","Alliowl"] },
      { "text": "E. Degup jantung cepat", "spirits": ["Gingeer","Bitty"] }
    ]
  },
  {
    "narrative": "Akhirnya kamu melihat sosok spirit bercahaya. Apa kesan pertamamu?",
    "options": [
      { "text": "A. Hangat menguatkan", "spirits": ["Kroot","Potatoad"] },
      { "text": "B. Menyentuh lembut", "spirits": ["Mubii","Alliowl"] },
      { "text": "C. Tegas memberi arah", "spirits": ["Onyun","Gingeer"] },
      { "text": "D. Mengajak bertanya", "spirits": ["Bitty","Banion"] },
      { "text": "E. Menantang rasa takut", "spirits": ["Gingeer","Banion"] }
    ]
  },
  {
    "narrative": "Spirit itu membimbingmu melewati lorong berikutnya. Bagaimana ia menunjukkan jalannya?",
    "options": [
      { "text": "A. Cahaya stabil di depan", "spirits": ["Onyun","Gingeer"] },
      { "text": "B. Sentuhan ringan di bahu", "spirits": ["Potatoad","Mubii"] },
      { "text": "C. Bisikan kata semangat", "spirits": ["Banion","Bitty"] },
      { "text": "D. Jejak lembut bercahaya", "spirits": ["Bitty","Kroot"] },
      { "text": "E. Bayangan penunjuk arah", "spirits": ["Alliowl","Onyun"] }
    ]
  },
  {
    "narrative": "Rintangan bayangan menari di dinding. Apa caramu menanggulanginya?",
    "options": [
      { "text": "A. Berdiri tetap tenang", "spirits": ["Kroot","Potatoad"] },
      { "text": "B. Melompat melewatinya", "spirits": ["Gingeer","Jinger"] },
      { "text": "C. Memutar badan menghindar", "spirits": ["Onyun","Bitty"] },
      { "text": "D. Mengikuti irama bayangan", "spirits": ["Bitty","Mubii"] },
      { "text": "E. Tanyakan pada spirit langkah selanjutnya", "spirits": ["Mubii","Alliowl"] }
    ]
  },
  {
    "narrative": "Sosok bayangan lain menahan langkah. Apa reaksi pertamamu?",
    "options": [
      { "text": "A. Tantang dengan kata-kata", "spirits": ["Gingeer","Onyun"] },
      { "text": "B. Beri senyum hangat", "spirits": ["Potatoad","Bitty"] },
      { "text": "C. Mundur dan diam", "spirits": ["Alliowl","Banion"] },
      { "text": "D. Sambut dengan pertanyaan", "spirits": ["Bitty","Kroot"] },
      { "text": "E. Berusaha melewati diam-diam", "spirits": ["Banion","Mubii"] }
    ]
  },
  {
    "narrative": "Cermin besar memantulkan cerita. Apa yang kamu lihat di cermin itu?",
    "options": [
      { "text": "A. Versi dirimu yang kuat", "spirits": ["Gingeer","Onyun"] },
      { "text": "B. Versi lelah ingin istirahat", "spirits": ["Potatoad","Kroot"] },
      { "text": "C. Versi emosional menangis", "spirits": ["Banion","Alliowl"] },
      { "text": "D. Versi penasaran bertanya", "spirits": ["Bitty","Mubii"] },
      { "text": "E. Versi diam mengamati", "spirits": ["Alliowl","Bitty"] }
    ]
  },
  {
    "narrative": "Kalian tiba di gerbang bercahaya, hampir keluar. Bagaimana perasaanmu?",
    "options": [
      { "text": "A. Siap menghadapi dunia", "spirits": ["Onyun","Gingeer"] },
      { "text": "B. Ragu untuk melangkah", "spirits": ["Banion","Bitty"] },
      { "text": "C. Tenang lega", "spirits": ["Potatoad","Kroot"] },
      { "text": "D. Penuh rasa ingin tahu", "spirits": ["Bitty","Alliowl"] },
      { "text": "E. Enggan berpisah", "spirits": ["Alliowl","Mubii"] }
    ]
  },
  {
    "narrative": "Spirit memegang tanganmu sekali lagi. Apa yang ia katakan?",
    "options": [
      { "text": "A. “Kamu cukup, berhenti sejenak.”", "spirits": ["Potatoad","Kroot"] },
      { "text": "B. “Emosimu valid, biarkan mengalir.”", "spirits": ["Banion","Alliowl"] },
      { "text": "C. “Tidak apa gagal, coba lagi.”", "spirits": ["Gingeer","Onyun"] },
      { "text": "D. “Percayalah pada rasa ingin tahu.”", "spirits": ["Bitty","Mubii"] },
      { "text": "E. “Hatimu terlindungi di sini.”", "spirits": ["Mubii","Bitty"] }
    ]
  },
  {
    "narrative": "Kamu merasa lebih ringan. Apa langkah pertamamu keluar?",
    "options": [
      { "text": "A. Berlari kecil sambil tersenyum", "spirits": ["Potatoad","Bitty"] },
      { "text": "B. Mantap melangkah pasti", "spirits": ["Onyun","Gingeer"] },
      { "text": "C. Perlahan menikmati setiap detik", "spirits": ["Alliowl","Kroot"] },
      { "text": "D. Lihat ke belakang sekali lagi", "spirits": ["Banion","Bitty"] },
      { "text": "E. Bertanya kapan bisa kembali", "spirits": ["Bitty","Mubii"] }
    ]
  },
  {
    "narrative": "Cahaya terang menerobos ujung lorong. Perasaan yang muncul?",
    "options": [
      { "text": "A. Suka cita hangat", "spirits": ["Potatoad","Kroot"] },
      { "text": "B. Terguncang bimbang", "spirits": ["Banion","Onyun"] },
      { "text": "C. Bersemangat memulai", "spirits": ["Gingeer","Bitty"] },
      { "text": "D. Damai dalam hati", "spirits": ["Mubii","Alliowl"] },
      { "text": "E. Sedih ingin bertahan", "spirits": ["Alliowl","Bitty"] }
    ]
  },
  {
    "narrative": "Chame merangkulmu satu kali. Responmu?",
    "options": [
      { "text": "A. Balik memeluk erat", "spirits": ["Potatoad","Mubii"] },
      { "text": "B. Menangis lega", "spirits": ["Banion","Bitty"] },
      { "text": "C. Tersenyum hangat", "spirits": ["Bitty","Kroot"] },
      { "text": "D. Mengangguk mantap", "spirits": ["Onyun","Gingeer"] },
      { "text": "E. Diam tapi bahagia", "spirits": ["Alliowl","Jinger"] }
    ]
  },
  {
    "narrative": "Kalian melangkah ke cahaya dan... Apa yang akan kamu katakan pada Chame?",
    "options": [
      { "text": "A. “Terima kasih, aku sudah siap.”", "spirits": ["Potatoad","Kroot"] },
      { "text": "B. “Aku takut, tapi mau coba.”", "spirits": ["Banion","Onyun"] },
      { "text": "C. “Kapan kita kembali ke sini?”", "spirits": ["Bitty","Alliowl"] },
      { "text": "D. “Ayo tantang lagi suatu hari.”", "spirits": ["Gingeer","Onyun"] },
      { "text": "E. “Aku akan menyimpan ini selamanya.”", "spirits": ["Alliowl","Mubii"] }
    ]
  },
  {
    "narrative": "Tie-Breaker: Kamu mendapati sebuah cermin kecil. Bayanganmu tampak lebih berani dari biasanya. Apa yang akan kau lakukan?",
    "options": [
      { "text": "A. Meniru keberanian itu", "spirits": ["Kroot"] },
      { "text": "B. Menyadari kerentananmu", "spirits": ["Banion"] },
      { "text": "C. Istirahat dan hentikan sejenak", "spirits": ["Potatoad"] },
      { "text": "D. Tegaskan batasan baru", "spirits": ["Mubii"] },
      { "text": "E. Bertanya pada diri sendiri", "spirits": ["Bitty"] }
    ]
  }
];

let current = parseInt(localStorage.getItem('currentQuestion') || 0);
let scores = JSON.parse(localStorage.getItem('scores') || '{}');

function renderQuestion() {
  const q = questions[current];
  document.getElementById("narrative").innerText = q.narrative;

  const optionsContainer = document.getElementById("options");
  optionsContainer.innerHTML = "";
  q.options.forEach((opt, i) => {
    const btn = document.createElement("button");
    btn.textContent = opt.text;
    btn.onclick = () => {
      opt.spirits.forEach(sp => {
        scores[sp] = (scores[sp] || 0) + 1;
      });
      localStorage.setItem('scores', JSON.stringify(scores));
      nextQuestion();
    };
    optionsContainer.appendChild(btn);
  });

  updateProgress();
}

function updateProgress() {
  const bar = "█".repeat(current + 1) + "▁".repeat(20 - current - 1);
  document.getElementById("progressBar").innerText = `Progress: ${bar}`;
}

function nextQuestion() {
  if (current >= questions.length - 1) {
    // Hitung hasil
    const sorted = Object.entries(scores).sort((a, b) => b[1] - a[1]);
    const winner = sorted[0][0];
    localStorage.setItem("finalSpirit", winner);
    window.location.href = "result.html";
  } else {
    current++;
    localStorage.setItem("currentQuestion", current);
    renderQuestion();
  }
}

function prevQuestion() {
  if (current > 0) {
    current--;
    localStorage.setItem("currentQuestion", current);
    renderQuestion();
  }
}

if (document.body.classList.contains("quiz")) {
  renderQuestion();
}
